<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taktflow SIL Demo</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <h1 class="logo">TAKTFLOW <span class="logo-accent">SIL DEMO</span></h1>
        </div>
        <div class="header-right">
            <span id="ws-status" class="status-badge disconnected">Disconnected</span>
            <span class="uptime-label">Uptime:</span>
            <span id="uptime" class="uptime-value">--:--:--</span>
            <span class="can-rate-label">CAN:</span>
            <span id="can-rate" class="can-rate-value">0 msg/s</span>
        </div>
    </header>

    <!-- Telemetry Grid -->
    <main class="grid">
        <!-- Vehicle State -->
        <section class="card" id="card-vehicle">
            <h2 class="card-title">Vehicle</h2>
            <div class="card-body">
                <div class="metric">
                    <span class="metric-label">State</span>
                    <span id="vehicle-state" class="metric-value state-badge">--</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Fault Mask</span>
                    <span id="vehicle-faults" class="metric-value">0x0000</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Torque Limit</span>
                    <span id="vehicle-torque-limit" class="metric-value"><span class="num">--</span>%</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Speed Limit</span>
                    <span id="vehicle-speed-limit" class="metric-value"><span class="num">--</span>%</span>
                </div>
            </div>
        </section>

        <!-- Motor -->
        <section class="card" id="card-motor">
            <h2 class="card-title">Motor</h2>
            <div class="card-body">
                <div class="metric">
                    <span class="metric-label">RPM</span>
                    <span id="motor-rpm" class="metric-value"><span class="num">--</span></span>
                </div>
                <div class="metric">
                    <span class="metric-label">Current</span>
                    <span id="motor-current" class="metric-value"><span class="num">--</span> mA</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Temp</span>
                    <span id="motor-temp" class="metric-value"><span class="num">--</span>&deg;C</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Temp 2</span>
                    <span id="motor-temp2" class="metric-value"><span class="num">--</span>&deg;C</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Duty</span>
                    <span id="motor-duty" class="metric-value"><span class="num">--</span>%</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Faults</span>
                    <span id="motor-faults" class="metric-value">0</span>
                </div>
            </div>
        </section>

        <!-- Steering -->
        <section class="card" id="card-steering">
            <h2 class="card-title">Steering</h2>
            <div class="card-body">
                <div class="metric">
                    <span class="metric-label">Angle</span>
                    <span id="steer-actual" class="metric-value"><span class="num">--</span>&deg;</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Command</span>
                    <span id="steer-cmd" class="metric-value"><span class="num">--</span>&deg;</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Servo</span>
                    <span id="steer-servo" class="metric-value"><span class="num">--</span> mA</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Fault</span>
                    <span id="steer-fault" class="metric-value fault-indicator">OK</span>
                </div>
            </div>
        </section>

        <!-- Brake -->
        <section class="card" id="card-brake">
            <h2 class="card-title">Brake</h2>
            <div class="card-body">
                <div class="metric">
                    <span class="metric-label">Position</span>
                    <span id="brake-pos" class="metric-value"><span class="num">--</span>%</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Command</span>
                    <span id="brake-cmd" class="metric-value"><span class="num">--</span>%</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Servo</span>
                    <span id="brake-servo" class="metric-value"><span class="num">--</span> mA</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Fault</span>
                    <span id="brake-fault" class="metric-value fault-indicator">OK</span>
                </div>
            </div>
        </section>

        <!-- Battery -->
        <section class="card" id="card-battery">
            <h2 class="card-title">Battery</h2>
            <div class="card-body">
                <div class="metric">
                    <span class="metric-label">Voltage</span>
                    <span id="batt-voltage" class="metric-value"><span class="num">--</span> V</span>
                </div>
                <div class="metric">
                    <span class="metric-label">SOC</span>
                    <span id="batt-soc" class="metric-value"><span class="num">--</span>%</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Status</span>
                    <span id="batt-status" class="metric-value">--</span>
                </div>
                <div class="bar-container">
                    <div id="batt-bar" class="bar" style="width:0%"></div>
                </div>
            </div>
        </section>

        <!-- LiDAR -->
        <section class="card" id="card-lidar">
            <h2 class="card-title">LiDAR</h2>
            <div class="card-body">
                <div class="metric">
                    <span class="metric-label">Distance</span>
                    <span id="lidar-dist" class="metric-value"><span class="num">--</span> cm</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Zone</span>
                    <span id="lidar-zone" class="metric-value">--</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Signal</span>
                    <span id="lidar-signal" class="metric-value"><span class="num">--</span></span>
                </div>
            </div>
        </section>

        <!-- ECU Heartbeats -->
        <section class="card" id="card-heartbeats">
            <h2 class="card-title">ECU Heartbeats</h2>
            <div class="card-body heartbeat-grid">
                <div class="heartbeat-item">
                    <span id="hb-cvc" class="hb-dot dead"></span>
                    <span class="hb-label">CVC</span>
                </div>
                <div class="heartbeat-item">
                    <span id="hb-fzc" class="hb-dot dead"></span>
                    <span class="hb-label">FZC</span>
                </div>
                <div class="heartbeat-item">
                    <span id="hb-rzc" class="hb-dot dead"></span>
                    <span class="hb-label">RZC</span>
                </div>
            </div>
        </section>

        <!-- Anomaly Detection -->
        <section class="card" id="card-anomaly">
            <h2 class="card-title">Anomaly Detection</h2>
            <div class="card-body">
                <div class="metric">
                    <span class="metric-label">Score</span>
                    <span id="anomaly-score" class="metric-value"><span class="num">0.00</span></span>
                </div>
                <div class="metric">
                    <span class="metric-label">Alert</span>
                    <span id="anomaly-alert" class="metric-value fault-indicator">OK</span>
                </div>
                <div class="bar-container">
                    <div id="anomaly-bar" class="bar bar-anomaly" style="width:0%"></div>
                </div>
            </div>
        </section>
    </main>

    <!-- Control Panel -->
    <section class="panel" id="control-panel">
        <div class="panel-header">
            <h2 class="panel-title">Control Panel</h2>
            <span id="lock-status" class="lock-badge unlocked">Unlocked</span>
        </div>
        <div class="panel-body">
            <div class="btn-group">
                <button class="btn btn-scenario" data-scenario="normal_drive">Normal</button>
                <button class="btn btn-scenario btn-danger" data-scenario="overcurrent">Overcurrent</button>
                <button class="btn btn-scenario btn-danger" data-scenario="steer_fault">Steer Fault</button>
                <button class="btn btn-scenario btn-danger" data-scenario="brake_fault">Brake Fault</button>
                <button class="btn btn-scenario btn-warning" data-scenario="battery_low">Battery Low</button>
                <button class="btn btn-scenario btn-critical" data-scenario="estop">E-Stop</button>
                <button class="btn btn-scenario btn-ok" data-scenario="reset">Reset</button>
            </div>
            <div class="btn-group lock-controls">
                <button id="btn-acquire" class="btn btn-lock">Acquire Lock</button>
                <button id="btn-release" class="btn btn-lock btn-outline">Release Lock</button>
                <span id="lock-remaining" class="lock-remaining"></span>
            </div>
        </div>
        <div id="control-feedback" class="control-feedback"></div>
    </section>

    <!-- Logs Row -->
    <div class="logs-row">
        <!-- CAN Log -->
        <section class="panel log-panel">
            <h2 class="panel-title">CAN Log</h2>
            <div id="can-log" class="log-scroll"></div>
        </section>

        <!-- Events -->
        <section class="panel log-panel">
            <h2 class="panel-title">Events</h2>
            <div id="event-log" class="log-scroll"></div>
        </section>
    </div>

    <!-- SAP QM Notifications -->
    <section class="panel" id="sap-panel">
        <h2 class="panel-title">SAP QM Notifications</h2>
        <div class="table-wrap">
            <table class="sap-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>DTC</th>
                        <th>Description</th>
                        <th>Plant</th>
                        <th>Priority</th>
                        <th>Status</th>
                        <th>Created</th>
                    </tr>
                </thead>
                <tbody id="sap-tbody"></tbody>
            </table>
        </div>
        <p id="sap-empty" class="empty-msg">No notifications yet. Trigger a fault to generate one.</p>
    </section>

    <footer class="footer">
        <span>Taktflow Systems &mdash; ISO 26262 ASIL D Zonal Vehicle Platform</span>
    </footer>

    <script src="app.js"></script>
</body>
</html>
